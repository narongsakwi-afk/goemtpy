<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡πÄ‡∏Å‡∏°‡∏´‡∏°‡∏≤‡∏Å‡∏•‡πâ‡∏≠‡∏° (Go) - ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå v2.5</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root{--board-size:15;--cell-size:28px;--color-light-bg:#f9f9f9;--color-dark-bg:#e0e0e0;--color-board:#f7d794;--color-wood-dark:#b8860b;--color-button:#4a90e2;--color-button-hover:#357ABD;--color-black:#000;--color-white:#fff;--font-family:'Kanit',sans-serif;--bg-color:var(--color-dark-bg)}body{font-family:var(--font-family);display:flex;flex-direction:column;align-items:center;padding:10px;margin:0;background-color:var(--bg-color);transition:background-color .4s ease;min-height:100vh;color:#333}h1,h2,h3{font-weight:600;color:#1e3a5f;margin-bottom:15px}#home-view,#lobby-view,#game-view,#waiting-room-view{display:none;width:100%;max-width:1200px;align-items:center;flex-direction:column;padding:15px}#home-view.active,#lobby-view.active,#game-view.active,#waiting-room-view.active{display:flex}.card{background-color:var(--color-white);border-radius:12px;box-shadow:0 8px 16px rgba(0,0,0,.15);padding:25px;margin-bottom:20px;width:100%;box-sizing:border-box}#home-view input,#create-room-section input{padding:10px;margin:5px 0 15px 10px;border:1px solid #ccc;border-radius:6px;font-size:16px;width:60%}button{padding:12px 25px;font-size:18px;margin:10px 8px;cursor:pointer;border:none;border-radius:8px;font-weight:600;transition:background-color .3s,transform .1s}button:disabled{background-color:#ccc;cursor:not-allowed}#online-players-section{text-align:left}#online-list{list-style-type:none;padding-left:0}#online-list li{padding:5px 0;border-bottom:1px solid #f0f0f0;color:#2e7d32;font-weight:500}#online-list li::before{content:'üü¢ '}#room-list{display:flex;flex-direction:column;gap:15px;margin-top:10px}.room-item{display:flex;justify-content:space-between;align-items:center;padding:15px;background-color:#f9f9f9;border-radius:8px;border:1px solid #eee}.player-slots{display:flex;justify-content:space-around;width:100%;margin:20px 0}.player-slot{width:45%;padding:20px;border:1px solid #ddd;border-radius:8px;text-align:center}.status-indicator{display:inline-block;padding:5px 12px;border-radius:15px;font-size:.9em;font-weight:600}#game-view{flex-direction:row;align-items:flex-start;position:relative}#player-info-container{width:220px;flex-shrink:0;margin-right:20px}.player-info-card{background:#fff;padding:15px;border-radius:8px;margin-bottom:15px;box-shadow:0 2px 4px rgba(0,0,0,.05)}#game-container{flex-shrink:0;text-align:center}#controls-panel{min-width:250px;text-align:center}#board{display:grid;grid-template-columns:repeat(var(--board-size),1fr);width:calc(var(--board-size) * var(--cell-size));height:calc(var(--board-size) * var(--cell-size));background-color:var(--color-board);border:4px solid var(--color-wood-dark)}.intersection{border-right:1px solid #333;border-bottom:1px solid #333;cursor:pointer;box-sizing:border-box;display:flex;justify-content:center;align-items:center;position:relative}.stone{width:80%;height:80%;border-radius:50%;position:absolute;box-shadow:0 2px 4px rgba(0,0,0,.4),inset 0 0 5px rgba(255,255,255,.4)}
        #developer-credit {position: fixed; bottom: 10px; right: 15px; font-size: 0.8em; color: #777; z-index: 9999;}
    </style>
</head>
<body>

    <div id="home-view" class="card active">
        <h2>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏°‡∏´‡∏°‡∏≤‡∏Å‡∏•‡πâ‡∏≠‡∏° (Go)</h2>
        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏•‡πá‡∏≠‡∏ö‡∏ö‡∏µ‡πâ</p>
        <input type="text" id="main-player-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" required>
        <button onclick="enterLobby()">üö™ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏•‡πá‡∏≠‡∏ö‡∏ö‡∏µ‡πâ</button>
    </div>

    <div id="lobby-view" class="card">
        <h2>Lobby</h2>
        <p>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, <strong id="lobby-player-name"></strong>!</p>
        <div id="online-players-section" class="card">
            <h3>üë• ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (<span id="online-count">0</span>)</h3>
            <ul id="online-list"></ul>
        </div>
        <div id="create-room-section" class="card">
            <h3>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
            <input type="text" id="room-name-input" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á..." required>
            <button onclick="createRoom()">‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á</button>
        </div>
        <div id="open-rooms-section" class="card">
            <h3>‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô ( <span id="room-count">0</span> )</h3>
            <div id="room-list"></div>
        </div>
    </div>

    <div id="waiting-room-view" class="card">
        <h2>‡∏´‡πâ‡∏≠‡∏á‡∏£‡∏≠‡πÄ‡∏•‡πà‡∏ô: <span id="waiting-room-name"></span></h2>
        <div class="player-slots">
            <div class="player-slot"><p><strong>‚ö™ ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á</strong></p><p id="waiting-p1-name">...</p></div>
            <div class="player-slot"><p><strong>‚ö´ ‡∏ú‡∏π‡πâ‡∏ó‡πâ‡∏≤‡∏ä‡∏¥‡∏á</strong></p><p id="waiting-p2-name">...‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠...</p></div>
        </div>
        <div id="waiting-room-controls">
             <button id="start-game-btn" style="display:none;">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
             <button id="ready-btn" style="display:none;">‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°</button>
             <button onclick="leaveRoom()">üè† ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡πâ‡∏≠‡∏á</button>
        </div>
    </div>

    <div id="game-view">
        <div id="my-player-info" class="player-info-card">
            <h4 id="my-info-name">My Name</h4>
        </div>
        <div id="game-container">
            <div id="board"></div>
        </div>
        <div id="controls-panel">
            <div id="current-status" class="card">
                <p><strong>‡∏ï‡∏≤‡πÄ‡∏î‡∏¥‡∏ô:</strong> <span id="current-player-name"></span></p><hr>
                <p><strong>‡∏´‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ:</strong></p>
                <p>‚ö´ <span id="p1-captured">0</span> | ‚ö™ <span id="p2-captured">0</span></p><hr>
                <p><strong>‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß:</strong></p>
                <p>‚ö´ <span id="p1-pass-count">0</span>/5 | ‚ö™ <span id="p2-pass-count">0</span>/5</p><hr>
                <p><strong>‡∏´‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</strong></p>
                <p>‚ö´ <span id="p1-moves-left">100</span> | ‚ö™ <span id="p2-moves-left">100</span></p>
            </div>
            <div id="controls">
                <button onclick="passMove()">ü§ù ‡∏ú‡πà‡∏≤‡∏ô</button>
                <button onclick="surrender()">üè≥Ô∏è ‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ</button>
                <button onclick="leaveRoom()">üè† ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡∏°</button>
            </div>
        </div>
    </div>

    <div id="developer-credit">‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤: ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå ‡∏ì‡∏£‡∏á‡∏Ñ‡πå‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏ß‡∏¥‡∏£‡∏∏‡∏ì‡∏û‡∏±‡∏ô‡∏ò‡πå</div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let mainPlayerName = '';
        let currentRoomId = null;

        const views = ['home-view', 'lobby-view', 'game-view', 'waiting-room-view'];
        const boardElement = document.getElementById('board');

        function showView(viewId) {
            views.forEach(id => document.getElementById(id).classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
        }

        function enterLobby() {
            const nameInput = document.getElementById('main-player-name').value;
            if (!nameInput.trim()) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì');
            mainPlayerName = nameInput.trim();
            document.getElementById('lobby-player-name').textContent = mainPlayerName;
            socket.emit('player_online', mainPlayerName); 
            gotoLobby();
        }
        
        function gotoLobby() {
            showView('lobby-view');
            socket.emit('get_rooms');
            currentRoomId = null;
        }
        
        function createRoom() {
            const roomName = document.getElementById('room-name-input').value.trim();
            if (!roomName) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á');
            socket.emit('create_room', { name: roomName, host: mainPlayerName });
        }
        
        function joinRoom(roomId) {
            socket.emit('join_room', { roomId, playerName: mainPlayerName });
        }

        function leaveRoom() {
            if(currentRoomId){
                socket.emit('leave_room', currentRoomId);
            } else {
                gotoLobby();
            }
        }
        
        function renderWaitingRoom(room) {
            currentRoomId = room.id;
            showView('waiting-room-view');
            document.getElementById('waiting-room-name').textContent = room.name;
            document.getElementById('waiting-p1
